<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vaccine Impact Modelling Consortium - Reset password</title>
    <link rel="stylesheet" href="css/third_party/bootstrap.min.css" />
    <link rel="stylesheet" href="css/montagu.css"/>
    <script src="js/third_party/jquery.min.js"></script>
    <script src="js/third_party/vue.min.js"></script>
    <script src="js/montagu-password.js"></script>
    <script src="js/montagu-utils.js"></script>
    <script src="js/components/montagu-reset-password.vue.js"></script>
</head>
<body>
<header class="header">
    <a href="https://vaccineimpact.org">
        <img class="pl-md-1 logo" src="logo.png" alt="Vaccine Impact Modelling Consortium" />
    </a>
    <div class="siteTitle">Montagu</div>
</header>
<div id="content"  class="container">
    <h1 class="header-small">Forgotten your password?</h1>

    <montagu-reset-password v-bind:email="email" v-bind:show-acknowledgement="showAcknowledgement"
                            v-bind:reset-password-error="resetPasswordError"
                            v-on:request-reset-link="requestResetLink"></montagu-reset-password>

</div>
</body>
<script>
    const passwordApi = new MontaguPassword();
    const utils = MontaguUtils;
    new Vue({
        el: "#content",
        data: {
            email: utils.paramFromQueryString(location.search, "email"),
            showAcknowledgement: false,
            resetPasswordError: ""
        },
        methods: {
            requestResetLink: function(email) {
                const data = this;
                passwordApi.requestResetLink(email).then(
                    () => {
                        data.email = email;
                        data.showAcknowledgement = true;
                        data.resetPasswordError = "";
                    },
                    (jqXHR) => {
                        data.resetPasswordError = "An error occurred";
                    }
                );
            }
        },
        components: {
            'montagu-reset-password': MontaguResetPassword
        }
    });
</script>
</html>
</html>