server {
    listen       443 ssl;
    server_name  localhost;

    ssl_certificate      /etc/montagu/proxy/certificate.pem;
    ssl_certificate_key  /etc/montagu/proxy/ssl_key.pem;

    root /usr/share/nginx/html;

    # Serve up a static page for confirming the server is running
    location / {
      try_files /index.html =404;
      expires 1y;
      add_header Cache-Control "public";
    }

    # Pass through to different containers based on url prefix.    

    location /api/ {
      proxy_pass http://api:8080/;
      proxy_redirect default;

      # proxy_buffering is off, otherwise nginx downloads 
      # the full request before passing it on: This is bad for large files.
      proxy_buffering off;
    }
    location /admin/ {
      proxy_pass http://admin/;
    }
    location /contribution/ {
      proxy_pass http://contrib/;
    }
}